import { Command } from "../interfaces";
import { isTransferable } from "../utils/is-transferable";

/**
 * Post a command to the main thread
 * @internal
 * @param command Requested command to respond to
 * @param result Result of the command
 */
export function postCommand(command: Command, result?: any | any[]): void {
  const { id, type } = command;
  const resultAsArray = Array.isArray(result) ? result : [result];
  (postMessage as any)(
    {
      id,
      type,
      result,
    },
    resultAsArray.filter((result) => isTransferable(result))
  );
}
